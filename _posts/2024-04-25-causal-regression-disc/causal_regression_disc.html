<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Causal Inference - Regression Discontinuity</title>



  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2024-04-25"/>
  <meta property="article:created" itemprop="dateCreated" content="2024-04-25"/>
  <meta name="article:author" content="Jasper Lok"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Causal Inference - Regression Discontinuity"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Causal Inference - Regression Discontinuity"/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Regression discontinuity i;citation_author=Andrew Heiss"/>
  <meta name="citation_reference" content="citation_title=Regression discontinuity;citation_author=Andrew Heiss"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","bibliography","biblio-style","link-citations","categories"]}},"value":[{"type":"character","attributes":{},"value":["Causal Inference - Regression Discontinuity"]},{"type":"NULL"},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Jasper Lok"]},{"type":"character","attributes":{},"value":["https://jasperlok.netlify.app/"]}]}]},{"type":"character","attributes":{},"value":["04-25-2024"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[4]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["ref.bib"]},{"type":"character","attributes":{},"value":["apa"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["Machine Learning","Causal Inference"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["causal_regression_disc_files/figure-html5/unnamed-chunk-14-1.png","causal_regression_disc_files/figure-html5/unnamed-chunk-15-1.png","causal_regression_disc_files/figure-html5/unnamed-chunk-15-2.png","causal_regression_disc_files/figure-html5/unnamed-chunk-4-1.png","causal_regression_disc_files/figure-html5/unnamed-chunk-5-1.png","causal_regression_disc_files/figure-html5/unnamed-chunk-6-1.png","causal_regression_disc_files/figure-html5/unnamed-chunk-8-1.png","data/attendance_program.csv","image/break.jpg","image/school.jpg","ref.bib"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="causal_regression_disc_files/header-attrs/header-attrs.js"></script>
  <script src="causal_regression_disc_files/jquery/jquery-3.6.0.min.js"></script>
  <script src="causal_regression_disc_files/popper/popper.min.js"></script>
  <link href="causal_regression_disc_files/tippy/tippy.css" rel="stylesheet" />
  <link href="causal_regression_disc_files/tippy/tippy-light-border.css" rel="stylesheet" />
  <script src="causal_regression_disc_files/tippy/tippy.umd.min.js"></script>
  <script src="causal_regression_disc_files/anchor/anchor.min.js"></script>
  <script src="causal_regression_disc_files/bowser/bowser.min.js"></script>
  <script src="causal_regression_disc_files/webcomponents/webcomponents.js"></script>
  <script src="causal_regression_disc_files/distill/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Causal Inference - Regression Discontinuity","authors":[{"author":"Jasper Lok","authorURL":"https://jasperlok.netlify.app/","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2024-04-25T00:00:00.000+08:00","citationText":"Lok, 2024"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Causal Inference - Regression Discontinuity</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">Machine Learning</div>
<div class="dt-tag">Causal Inference</div>
</div>
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  Jasper Lok <a href="https://jasperlok.netlify.app/" class="uri">https://jasperlok.netlify.app/</a> 
  
<br/>04-25-2024
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#what-is-regression-discontinuity" id="toc-what-is-regression-discontinuity">What is regression discontinuity?</a></li>
<li><a href="#why-use-this-method" id="toc-why-use-this-method">Why use this method?</a></li>
<li><a href="#important-considerations" id="toc-important-considerations">Important considerations</a>
<ul>
<li><a href="#bandwidth" id="toc-bandwidth">Bandwidth</a></li>
<li><a href="#local-average-treatment-effect-late" id="toc-local-average-treatment-effect-late">Local average treatment effect (LATE)</a></li>
<li><a href="#manipulation" id="toc-manipulation">Manipulation</a></li>
<li><a href="#noncompliance" id="toc-noncompliance">Noncompliance</a></li>
</ul></li>
<li><a href="#demonstration" id="toc-demonstration">Demonstration</a>
<ul>
<li><a href="#import-data" id="toc-import-data">Import Data</a></li>
<li><a href="#visual-inspection" id="toc-visual-inspection">Visual Inspection</a>
<ul>
<li><a href="#overall" id="toc-overall">Overall</a></li>
<li><a href="#check-for-any-manipulation" id="toc-check-for-any-manipulation">Check for any manipulation</a></li>
</ul></li>
<li><a href="#estimation" id="toc-estimation">Estimation</a>
<ul>
<li><a href="#linear-model" id="toc-linear-model">Linear model</a></li>
<li><a href="#nonparametric-estimation" id="toc-nonparametric-estimation">Nonparametric estimation</a></li>
<li><a href="#sentivity-of-the-bandwidth" id="toc-sentivity-of-the-bandwidth">Sentivity of the bandwidth</a></li>
</ul></li>
</ul></li>
<li><a href="#conclusion" id="toc-conclusion">Conclusion</a></li>
</ul>
</nav>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="image/school.jpg" width="100%" /></p>
</div>
<p>Photo by <a href="https://unsplash.com/@taypaigey?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash">Taylor Flowe</a> on <a href="https://unsplash.com/photos/woman-in-gray-sweater-sitting-beside-woman-in-gray-sweater-NTur2_QKpg0?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash">Unsplash</a></p>
<p>In this post, I will be exploring another causal inference technique, which is regression discontinuity.</p>
<h1 id="what-is-regression-discontinuity">What is regression discontinuity?</h1>
<p>Before we start, let’s look at some terminology:</p>
<ul>
<li><p>Running variable: a.k.a. Forcing variable, the continuous variable that determines whether one is in the treatment or control group</p></li>
<li><p>Cutoff: the cutoff value on the running variable to determine whether one is in treatment or control group</p></li>
<li><p>Bandwidth: the bandwidth is used to determine the value range around the cutoff that should be included in the study</p></li>
</ul>
<p>The idea is that the people near the threshold should be similar. This allows us to have the pseudo-treatment and control group to measure the causal effect.</p>
<h1 id="why-use-this-method">Why use this method?</h1>
<p><span class="citation" data-cites="Heiss2023">(<a href="#ref-Heiss2023" role="doc-biblioref">Heiss 2023b</a>)</span> explained in his lecture slides that this method is less susceptible to p-hacking and selective publication than DID and IV.</p>
<h1 id="important-considerations">Important considerations</h1>
<h2 id="bandwidth">Bandwidth</h2>
<p>One of the important considerations is the bandwidth.</p>
<p>If the bandwidth is too narrow, we are throwing away a lot of the data in measuring the causal effect.</p>
<p>If the bandwidth is too wide, then the data points might not be comparable, which contradicts the similarity assumption we made in this analysis.</p>
<p>One method to overcome this is to double and halve the selected bandwidth and measure the effect.</p>
<h2 id="local-average-treatment-effect-late">Local average treatment effect (LATE)</h2>
<p>Another issue is we are only measuring the average treatment effect for the people in the bandwidth <span class="citation" data-cites="Heiss2023">(<a href="#ref-Heiss2023" role="doc-biblioref">Heiss 2023b</a>)</span>.</p>
<p>Hence, we are unable to make a population-level claim with a LATE.</p>
<h2 id="manipulation">Manipulation</h2>
<p>People might “manipulate” the results if they are aware of the threshold.</p>
<p>The issue is that the people near the threshold are no longer comparable treatment/control groups.</p>
<p>To check this, we can run a McCrary density test.</p>
<h2 id="noncompliance">Noncompliance</h2>
<p>Sometimes the cutoff may not be very “clean” as well.</p>
<p>So, we could use fuzzy discontinuities.</p>
<p>We will leave the exploration of this technique to a future post.</p>
<h1 id="demonstration">Demonstration</h1>
<p>In this post, I will be using the following packages to perform the analysis.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>pacman</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/pacman/man/p_load.html'>p_load</a></span><span class='op'>(</span><span class='va'>tidyverse</span>, <span class='va'>rdrobust</span>, <span class='va'>rddensity</span>, <span class='va'>broom</span>, <span class='va'>modelsummary</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="import-data">Import Data</h2>
<p>I will be using the fake policy dataset shared by Professor Andrew Heiss on his teaching website. I have also referred to the materials and problem set he posted on the course website.</p>
<p>Refer to <a href="https://evalsp23.classes.andrewheiss.com/assignment/06-problem-set.html">this link</a> for the dataset.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>program</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/attendance_program.csv"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>This is a fake dataset on the effect of a hypothetical program on hypothetical student grades. Students with less than 80% attendance would be required to attend a mandatory school attendance program.</p>
<p>At the end of their senior year, they will take a final test to assess their overall learning in the high school.</p>
<p>Below are the definitions of the columns in the dataset:</p>
<ul>
<li><code>id</code>: A randomly assigned student ID number</li>
<li><code>attendance</code>: The proportion of days of school attended during a student’s junior year (ranges from 0 to 100)</li>
<li><code>treatment</code>: Binary variable indicating if a student was assigned to the attendance program during their senior year</li>
<li><code>grade</code>: A student’s final test grade at the end of their senior year</li>
</ul>
<h2 id="visual-inspection">Visual Inspection</h2>
<h3 id="overall">Overall</h3>
<p>First, I will inspect the results.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>program</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>attendance</span>, <span class='va'>grade</span>, color <span class='op'>=</span> <span class='va'>treatment</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'>geom_point</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>0.9</span>, alpha <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'>geom_vline</span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>80</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="causal_regression_disc_files/figure-html5/unnamed-chunk-4-1.png" width="100%" /></p>
</div>
<p>It seems like there is a discontinuity, especially around the attendance 80.</p>
<p>We could further add the regression lines to the chart.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>program</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>attendance</span>, <span class='va'>grade</span>, color <span class='op'>=</span> <span class='va'>treatment</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'>geom_point</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>0.9</span>, alpha <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'>geom_smooth</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>program</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>attendance</span> <span class='op'>&lt;=</span> <span class='fl'>80</span><span class='op'>)</span></span>
<span>              ,method <span class='op'>=</span> <span class='st'>"lm"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'>geom_smooth</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>program</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>attendance</span> <span class='op'>&gt;</span> <span class='fl'>80</span><span class='op'>)</span></span>
<span>              ,method <span class='op'>=</span> <span class='st'>"lm"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'>geom_vline</span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>80</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="causal_regression_disc_files/figure-html5/unnamed-chunk-5-1.png" width="100%" /></p>
</div>
<p>Based on the chart, it looks like the program does have some effects on the student’s final exam results.</p>
<h3 id="check-for-any-manipulation">Check for any manipulation</h3>
<p>One important check in any regression discontinuity analysis is to check for any manipulation around the threshold.</p>
<p>We can do that by plotting the histogram of attendance.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>program</span>, <span class='fu'>aes</span><span class='op'>(</span><span class='va'>attendance</span>, fill <span class='op'>=</span> <span class='va'>treatment</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'>geom_histogram</span><span class='op'>(</span>binwidth <span class='op'>=</span> <span class='fl'>2</span>, color <span class='op'>=</span> <span class='st'>"white"</span>, boundary <span class='op'>=</span> <span class='fl'>80</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'>geom_vline</span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>80</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="causal_regression_disc_files/figure-html5/unnamed-chunk-6-1.png" width="100%" /></p>
</div>
<p>It doesn’t seem like there is a big jump around the cutoff.</p>
<p>We can further check this by using McCrary density test.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>density_test</span> <span class='op'>&lt;-</span> <span class='fu'>rddensity</span><span class='op'>(</span><span class='va'>program</span><span class='op'>$</span><span class='va'>attendance</span>, c <span class='op'>=</span> <span class='fl'>80</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>density_test</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
Manipulation testing using local polynomial density estimation.

Number of obs =       1200
Model =               unrestricted
Kernel =              triangular
BW method =           estimated
VCE method =          jackknife

c = 80                Left of c           Right of c          
Number of obs         681                 519                 
Eff. Number of obs    384                 421                 
Order est. (p)        2                   2                   
Order bias (q)        3                   3                   
BW est. (h)           13.574              12.521              

Method                T                   P &gt; |T|             
Robust                0.7748              0.4384              


P-values of binomial tests (H0: p=0.5).

Window Length / 2          &lt;c     &gt;=c    P&gt;|T|
0.820                      20      28    0.3123
1.640                      50      63    0.2589
2.460                      72      90    0.1815
3.280                     102     110    0.6308
4.100                     126     146    0.2493
4.920                     149     172    0.2194
5.740                     175     205    0.1367
6.560                     198     232    0.1114
7.380                     229     254    0.2748
8.200                     258     280    0.3653</code></pre>
</div>
<p>From the results above, we noted the following:</p>
<ul>
<li><p>The total number of data points in the data is 1,200</p>
<ul>
<li>Left side has 681 data and right side has 519</li>
</ul></li>
<li><p>The algorithm uses a triangular kernel with the bandwidth of 13.574 and 12.521</p>
<ul>
<li>The effective sample sizes become 384 and 421 after applying the kernel</li>
</ul></li>
<li><p>The p-value is 0.4384, suggesting that there is no statistical evidence of systematic manipulation of the running variables</p></li>
</ul>
<p>We could also visualize the output by passing the created <code>density_test</code> object into <code>rdplotdensity</code> function as shown below.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mccrary_test</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'>rdplotdensity</span><span class='op'>(</span>rdd <span class='op'>=</span> <span class='va'>density_test</span></span>
<span>                ,X <span class='op'>=</span> <span class='va'>program</span><span class='op'>$</span><span class='va'>attendance</span></span>
<span>                ,type <span class='op'>=</span> <span class='st'>"both"</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="causal_regression_disc_files/figure-html5/unnamed-chunk-8-1.png" width="100%" /></p>
</div>
<h2 id="estimation">Estimation</h2>
<p>Next, I will start estimating the effect of the program.</p>
<p>Before fitting the linear model, I will center the attendance. This would make the intercept easier to interpret.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>program</span> <span class='op'>&lt;-</span> <span class='va'>program</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>attendance_centered <span class='op'>=</span> <span class='va'>attendance</span> <span class='op'>-</span> <span class='fl'>80</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h3 id="linear-model">Linear model</h3>
<p>First, I will use a linear model to estimate the effect of the program. I will be using all the full data to perform the estimation as well.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>model_lm_all</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>grade</span> <span class='op'>~</span> <span class='va'>attendance_centered</span> <span class='op'>+</span> <span class='va'>treatment</span></span>
<span>                ,data <span class='op'>=</span> <span class='va'>program</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'>tidy</span><span class='op'>(</span><span class='va'>model_lm_all</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 3 × 5
  term                estimate std.error statistic  p.value
  &lt;chr&gt;                  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)            66.2     0.330     201.   0       
2 attendance_centered     1.56    0.0203     76.6  0       
3 treatmentTRUE           5.88    0.595       9.89 3.07e-22</code></pre>
</div>
<p>Based on the result above, the p-value for treatment is less than 0.05, suggesting that there is statistical evidence that the program effect is not zero.</p>
<p>We can control the effects of other covariates in the same formula as well.</p>
<p>However, the characteristics of the students may not be similar across the entire dataset.</p>
<p>The students are likely to be more similar to one another around the threshold.</p>
<p>With that, we could build the linear model with a smaller subset of the data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>model_lm_5</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>grade</span> <span class='op'>~</span> <span class='va'>attendance_centered</span> <span class='op'>+</span> <span class='va'>treatment</span></span>
<span>                ,data <span class='op'>=</span> <span class='va'>program</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>attendance_centered</span><span class='op'>)</span> <span class='op'>&lt;=</span> <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>model_lm_10</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>grade</span> <span class='op'>~</span> <span class='va'>attendance_centered</span> <span class='op'>+</span> <span class='va'>treatment</span></span>
<span>                ,data <span class='op'>=</span> <span class='va'>program</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>attendance_centered</span><span class='op'>)</span> <span class='op'>&lt;=</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>We could compile the model results by using <code>modelsummary</code> function for further comparison.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>modelsummary</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>model_lm_all</span>, <span class='va'>model_lm_5</span>, <span class='va'>model_lm_10</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<table style="width:81%;">
<colgroup>
<col style="width: 30%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><ol type="1">
<li></li>
</ol></th>
<th><ol start="2" type="1">
<li></li>
</ol></th>
<th><ol start="3" type="1">
<li></li>
</ol></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td>66.191</td>
<td>64.050</td>
<td>64.195</td>
</tr>
<tr class="even">
<td></td>
<td>(0.330)</td>
<td>(0.859)</td>
<td>(0.601)</td>
</tr>
<tr class="odd">
<td>attendance_centered</td>
<td>1.560</td>
<td>2.148</td>
<td>2.026</td>
</tr>
<tr class="even">
<td></td>
<td>(0.020)</td>
<td>(0.272)</td>
<td>(0.097)</td>
</tr>
<tr class="odd">
<td>treatmentTRUE</td>
<td>5.884</td>
<td>12.340</td>
<td>11.869</td>
</tr>
<tr class="even">
<td></td>
<td>(0.595)</td>
<td>(1.575)</td>
<td>(1.094)</td>
</tr>
<tr class="odd">
<td>Num.Obs.</td>
<td>1200</td>
<td>330</td>
<td>640</td>
</tr>
<tr class="even">
<td>R2</td>
<td>0.907</td>
<td>0.169</td>
<td>0.505</td>
</tr>
<tr class="odd">
<td>R2 Adj.</td>
<td>0.907</td>
<td>0.163</td>
<td>0.503</td>
</tr>
<tr class="even">
<td>AIC</td>
<td>7924.3</td>
<td>2228.8</td>
<td>4297.8</td>
</tr>
<tr class="odd">
<td>BIC</td>
<td>7944.6</td>
<td>2244.0</td>
<td>4315.6</td>
</tr>
<tr class="even">
<td>Log.Lik.</td>
<td>-3958.135</td>
<td>-1110.378</td>
<td>-2144.889</td>
</tr>
<tr class="odd">
<td>F</td>
<td>5823.048</td>
<td>33.144</td>
<td>324.837</td>
</tr>
<tr class="even">
<td>RMSE</td>
<td>6.55</td>
<td>7.00</td>
<td>6.91</td>
</tr>
</tbody>
</table>
</div>
<p>From the results above, we can see that the estimated effect will differ widely depending on the bandwidths we are using.</p>
<p>Then, how do we know which bandwidth should we be using?</p>
<h3 id="nonparametric-estimation">Nonparametric estimation</h3>
<p>Next, I will use a nonparametric approach to estimate the appropriate bandwidth for estimation.</p>
<p>I will use <code>rdrobust</code> function as shown below.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>rdrobust</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>program</span><span class='op'>$</span><span class='va'>grade</span></span>
<span>         ,x <span class='op'>=</span> <span class='va'>program</span><span class='op'>$</span><span class='va'>attendance</span></span>
<span>         ,c <span class='op'>=</span> <span class='fl'>80</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                 1200
BW type                       mserd
Kernel                   Triangular
VCE method                       NN

Number of Obs.                  681          519
Eff. Number of Obs.             255          279
Order est. (p)                    1            1
Order bias  (q)                   2            2
BW est. (h)                   8.112        8.112
BW bias (b)                  12.449       12.449
rho (h/b)                     0.652        0.652
Unique Obs.                     627          451

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional   -12.013     1.394    -8.619     0.000   [-14.745 , -9.281]    
        Robust         -         -    -7.244     0.000   [-15.473 , -8.883]    
=============================================================================</code></pre>
</div>
<p>Below are some explanations of the results:</p>
<ul>
<li><p>Similarly, the number of observations is 681 and 519 respectively</p></li>
<li><p>The bandwidth used is +/- 8.112</p></li>
<li><p>The default kernel is triangular</p></li>
<li><p>Effect is estimated to be 12.013</p>
<ul>
<li>The p-value is less than 0.05, suggesting that there is statistical evidence that the program effect is not zero</li>
</ul></li>
</ul>
<p>We can also plot out the results by using <code>rdplot</code> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>rdplot</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>program</span><span class='op'>$</span><span class='va'>grade</span></span>
<span>       ,x <span class='op'>=</span> <span class='va'>program</span><span class='op'>$</span><span class='va'>attendance</span></span>
<span>       ,c <span class='op'>=</span> <span class='fl'>80</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="causal_regression_disc_files/figure-html5/unnamed-chunk-14-1.png" width="100%" /></p>
</div>
<p>We could modify the items in the graph through the usual <code>ggplot</code> approach.</p>
<p>However, we need to do an extra step to save the plot into an object and extract the plot by using <code>$</code> as shown below.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>plot_rdrobust</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'>rdplot</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>program</span><span class='op'>$</span><span class='va'>grade</span></span>
<span>         ,x <span class='op'>=</span> <span class='va'>program</span><span class='op'>$</span><span class='va'>attendance</span></span>
<span>         ,c <span class='op'>=</span> <span class='fl'>80</span><span class='op'>)</span></span></code></pre>
</div>
<img src="causal_regression_disc_files/figure-html5/unnamed-chunk-15-1.png" width="100%" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>plot_rdrobust</span><span class='op'>$</span><span class='va'>rdplot</span> <span class='op'>+</span></span>
<span>  <span class='fu'>xlab</span><span class='op'>(</span><span class='st'>"Attendance"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'>ylab</span><span class='op'>(</span><span class='st'>"Grade"</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="causal_regression_disc_files/figure-html5/unnamed-chunk-15-2.png" width="100%" /></p>
</div>
<h3 id="sentivity-of-the-bandwidth">Sentivity of the bandwidth</h3>
<p>By default, <code>rdrobust</code> function will choose the bandwidth. We could also use <code>rdbwselect</code> function to see what other bandwidth choices we have.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>rdbwselect</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>program</span><span class='op'>$</span><span class='va'>grade</span></span>
<span>           ,x <span class='op'>=</span> <span class='va'>program</span><span class='op'>$</span><span class='va'>attendance</span></span>
<span>           ,c <span class='op'>=</span> <span class='fl'>80</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call: rdbwselect

Number of Obs.                 1200
BW type                       mserd
Kernel                   Triangular
VCE method                       NN

Number of Obs.                  681          519
Order est. (p)                    1            1
Order bias  (q)                   2            2
Unique Obs.                     627          451

=======================================================
                  BW est. (h)    BW bias (b)
            Left of c Right of c  Left of c Right of c
=======================================================
     mserd     8.112      8.112     12.449     12.449
=======================================================</code></pre>
</div>
<p>Including <code>TRUE</code> in the <code>all</code> argument will show us all the different bandwidths under different algorithms.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>rdbwselect</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>program</span><span class='op'>$</span><span class='va'>grade</span></span>
<span>           ,x <span class='op'>=</span> <span class='va'>program</span><span class='op'>$</span><span class='va'>attendance</span></span>
<span>           ,c <span class='op'>=</span> <span class='fl'>80</span></span>
<span>           ,all <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Call: rdbwselect

Number of Obs.                 1200
BW type                         All
Kernel                   Triangular
VCE method                       NN

Number of Obs.                  681          519
Order est. (p)                    1            1
Order bias  (q)                   2            2
Unique Obs.                     627          451

=======================================================
                  BW est. (h)    BW bias (b)
            Left of c Right of c  Left of c Right of c
=======================================================
     mserd     8.112      8.112     12.449     12.449
    msetwo    11.921      7.160     19.516     11.541
    msesum     7.172      7.172     12.341     12.341
  msecomb1     7.172      7.172     12.341     12.341
  msecomb2     8.112      7.172     12.449     12.341
     cerrd     5.691      5.691     12.449     12.449
    certwo     8.363      5.023     19.516     11.541
    cersum     5.032      5.032     12.341     12.341
  cercomb1     5.032      5.032     12.341     12.341
  cercomb2     5.691      5.032     12.449     12.341
=======================================================</code></pre>
</div>
<p>Another common approach to performing sensitivity testing on the bandwidth is to use ideal bandwidth, twice the ideal and half the ideal <span class="citation" data-cites="exampleHeiss2023">(<a href="#ref-exampleHeiss2023" role="doc-biblioref">Heiss 2023a</a>)</span>.</p>
<p><strong>Twice the ideal</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>rdrobust</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>program</span><span class='op'>$</span><span class='va'>grade</span></span>
<span>         ,x <span class='op'>=</span> <span class='va'>program</span><span class='op'>$</span><span class='va'>attendance</span></span>
<span>         ,c <span class='op'>=</span> <span class='fl'>80</span></span>
<span>         ,h <span class='op'>=</span> <span class='fl'>8.112</span> <span class='op'>*</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                 1200
BW type                      Manual
Kernel                   Triangular
VCE method                       NN

Number of Obs.                  681          519
Eff. Number of Obs.             436          490
Order est. (p)                    1            1
Order bias  (q)                   2            2
BW est. (h)                  16.224       16.224
BW bias (b)                  16.224       16.224
rho (h/b)                     1.000        1.000
Unique Obs.                     681          519

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional   -11.327     0.980   -11.554     0.000   [-13.248 , -9.405]    
        Robust         -         -    -8.613     0.000   [-15.499 , -9.753]    
=============================================================================</code></pre>
</div>
<p><strong>Half the ideal</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>rdrobust</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>program</span><span class='op'>$</span><span class='va'>grade</span></span>
<span>         ,x <span class='op'>=</span> <span class='va'>program</span><span class='op'>$</span><span class='va'>attendance</span></span>
<span>         ,c <span class='op'>=</span> <span class='fl'>80</span></span>
<span>         ,h <span class='op'>=</span> <span class='fl'>8.112</span> <span class='op'>/</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Sharp RD estimates using local polynomial regression.

Number of Obs.                 1200
BW type                      Manual
Kernel                   Triangular
VCE method                       NN

Number of Obs.                  681          519
Eff. Number of Obs.             122          146
Order est. (p)                    1            1
Order bias  (q)                   2            2
BW est. (h)                   4.056        4.056
BW bias (b)                   4.056        4.056
rho (h/b)                     1.000        1.000
Unique Obs.                     681          519

=============================================================================
        Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       
=============================================================================
  Conventional   -12.761     2.000    -6.380     0.000   [-16.681 , -8.841]    
        Robust         -         -    -3.913     0.000   [-16.492 , -5.485]    
=============================================================================</code></pre>
</div>
<p>Based on the results of the revised bandwidth, it doesn’t seem like there are any significant differences in estimated effect.</p>
<p>I will explore how to perform fuzzy regression discontinuity in the future post.</p>
<h1 id="conclusion">Conclusion</h1>
<p>That’s all for the day!</p>
<p>Thanks for reading the post until the end.</p>
<p>Feel free to contact me through <a href="mailto:jasper.jh.lok@gmail.com">email</a> or <a href="https://www.linkedin.com/in/jasper-l-13426232/">LinkedIn</a> if you have any suggestions on future topics to share.</p>
<p>Refer to this link for the <a href="https://jasperlok.netlify.app/blog_disclaimer.html">blog disclaimer</a>.</p>
<p>Till next time, happy learning!</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="image/break.jpg" width="100%" /></p>
</div>
<p>Photo by <a href="https://unsplash.com/@pickledstardust?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash">Pickled Stardust</a> on <a href="https://unsplash.com/photos/red-and-blue-ball-illustration-ELxsvsbGCo4?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash">Unsplash</a></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-exampleHeiss2023" class="csl-entry" role="listitem">
Heiss, Andrew. 2023a. <span>“Regression Discontinuity.”</span> <a href="https://evalsp23.classes.andrewheiss.com/example/rdd.html">https://evalsp23.classes.andrewheiss.com/example/rdd.html</a>.
</div>
<div id="ref-Heiss2023" class="csl-entry" role="listitem">
———. 2023b. <span>“Regression Discontinuity i.”</span> <a href="https://evalsp23.classes.andrewheiss.com/content/10-content.html">https://evalsp23.classes.andrewheiss.com/content/10-content.html</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
