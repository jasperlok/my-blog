<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Multinomial Logistic Regression</title>

  <meta property="description" itemprop="description" content="When the target is more than 2 classes"/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2024-01-06"/>
  <meta property="article:created" itemprop="dateCreated" content="2024-01-06"/>
  <meta name="article:author" content="Jasper Lok"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Multinomial Logistic Regression"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="When the target is more than 2 classes"/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Multinomial Logistic Regression"/>
  <meta property="twitter:description" content="When the target is more than 2 classes"/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Multinomial logistic regression vs one-vs-rest binary logistic regression;citation_author=Multinomial logistic regression vs one-vs-rest binary logistic regression"/>
  <meta name="citation_reference" content="citation_title=Multinomial logistic regression;citation_author=Multinomial logistic regression"/>
  <meta name="citation_reference" content="citation_title=A recommended preprocessing;citation_author=Max Kuhn;citation_author=Julia Silge"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","bibliography","biblio-style","link-citations","categories"]}},"value":[{"type":"character","attributes":{},"value":["Multinomial Logistic Regression"]},{"type":"character","attributes":{},"value":["When the target is more than 2 classes\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Jasper Lok"]},{"type":"character","attributes":{},"value":["https://jasperlok.netlify.app/"]}]}]},{"type":"character","attributes":{},"value":["01-06-2024"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[4]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["ref.bib"]},{"type":"character","attributes":{},"value":["apa"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["Machine Learning","Supervised Learning"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["image/penguins.jpg","image/penguins2.jpg","multinomial_files/anchor/anchor.min.js","multinomial_files/bowser/bowser.min.js","multinomial_files/distill/template.v2.js","multinomial_files/header-attrs/header-attrs.js","multinomial_files/jquery/jquery-3.6.0.js","multinomial_files/jquery/jquery-3.6.0.min.js","multinomial_files/jquery/jquery-3.6.0.min.map","multinomial_files/popper/popper.min.js","multinomial_files/tippy/tippy-bundle.umd.min.js","multinomial_files/tippy/tippy-light-border.css","multinomial_files/tippy/tippy.css","multinomial_files/tippy/tippy.umd.min.js","multinomial_files/webcomponents/webcomponents.js","ref.bib"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="multinomial_files/header-attrs/header-attrs.js"></script>
  <script src="multinomial_files/jquery/jquery-3.6.0.min.js"></script>
  <script src="multinomial_files/popper/popper.min.js"></script>
  <link href="multinomial_files/tippy/tippy.css" rel="stylesheet" />
  <link href="multinomial_files/tippy/tippy-light-border.css" rel="stylesheet" />
  <script src="multinomial_files/tippy/tippy.umd.min.js"></script>
  <script src="multinomial_files/anchor/anchor.min.js"></script>
  <script src="multinomial_files/bowser/bowser.min.js"></script>
  <script src="multinomial_files/webcomponents/webcomponents.js"></script>
  <script src="multinomial_files/distill/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Multinomial Logistic Regression","description":"When the target is more than 2 classes","authors":[{"author":"Jasper Lok","authorURL":"https://jasperlok.netlify.app/","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2024-01-06T00:00:00.000+08:00","citationText":"Lok, 2024"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Multinomial Logistic Regression</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">Machine Learning</div>
<div class="dt-tag">Supervised Learning</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>When the target is more than 2 classes</p></p>
</div>

<div class="d-byline">
  Jasper Lok <a href="https://jasperlok.netlify.app/" class="uri">https://jasperlok.netlify.app/</a> 
  
<br/>01-06-2024
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#what-is-multinomial-logistic-regression" id="toc-what-is-multinomial-logistic-regression">What is multinomial logistic regression?</a></li>
<li><a href="#assumptions-of-multinomial-logistic-regression" id="toc-assumptions-of-multinomial-logistic-regression">Assumptions of multinomial logistic regression</a></li>
<li><a href="#demonstration" id="toc-demonstration">Demonstration</a>
<ul>
<li><a href="#setup-the-environment" id="toc-setup-the-environment">Setup the environment</a></li>
<li><a href="#brulee-package" id="toc-brulee-package"><code>brulee</code> package</a></li>
<li><a href="#vglm-function-from-vgam-package" id="toc-vglm-function-from-vgam-package"><code>vglm</code> function from <code>VGAM</code> package</a></li>
<li><a href="#multinom-function-from-nnet-package" id="toc-multinom-function-from-nnet-package"><code>multinom</code> function from <code>nnet</code> package</a></li>
</ul></li>
<li><a href="#conclusion" id="toc-conclusion">Conclusion</a></li>
</ul>
</nav>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="image/penguins.jpg" width="100%" /></p>
</div>
<p>Photo by <a href="https://unsplash.com/@photos_by_ryder?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash">Joshua Ryder</a> on <a href="https://unsplash.com/photos/white-and-black-penguin-in-water-aRD43BMqAp8?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash">Unsplash</a></p>
<p>In this post, I will be exploring what is multinomial logistic regression and how to build a multinomial logistic regression model.</p>
<h1 id="what-is-multinomial-logistic-regression">What is multinomial logistic regression?</h1>
<p>As the name suggested, this model can predict more than 2 classes, which is different from the normal logistic regression.</p>
<p>This would be very handy when the target variable has more than 2 categories and the categories are unordered.</p>
<p>The author of this post gave a summary between multinomial logistic regression and one-vs-all logistic regression <span class="citation" data-cites="CrossValidated2013">(<a href="#ref-CrossValidated2013" role="doc-biblioref">Cross Validated 2013</a>)</span>.</p>
<h1 id="assumptions-of-multinomial-logistic-regression">Assumptions of multinomial logistic regression</h1>
<p>Some of the assumptions of multinomial logistic regression include <span class="citation" data-cites="ASC2024">(<a href="#ref-ASC2024" role="doc-biblioref">National University Academic Success Centre 2024</a>)</span>:</p>
<ul>
<li><p>Independence of observations</p></li>
<li><p>Categories of the outcome variable must be mutually exclusive and exhaustive</p></li>
<li><p>No multicollinearity between independent variables</p></li>
<li><p>Linear relationship between continuous variables and the logit transformation of the outcome variable</p></li>
<li><p>No outliers or highly influential points</p></li>
</ul>
<h1 id="demonstration">Demonstration</h1>
<p>According to CRAN, different packages would help us to model multi-state (e.g. <code>mstate</code>, <code>msm</code>).</p>
<p>In this demonstration, I will be using different functions to fit a multinomial regression.</p>
<h2 id="setup-the-environment">Setup the environment</h2>
<p>First, I will load the necessary packages into the environment.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>pacman</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/pacman/man/p_load.html'>p_load</a></span><span class='op'>(</span><span class='va'>tidyverse</span>, <span class='va'>tidymodels</span>, <span class='va'>palmerpenguins</span>, <span class='va'>brulee</span>, <span class='va'>VGAM</span>, <span class='va'>nnet</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>If we were to call the dataset, we would notice that there are some missing values within the dataset.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>penguins</span></span></code></pre>
</div>
<pre><code># A tibble: 344 x 8
   species island    bill_length~1 bill_~2 flipp~3 body_~4 sex    year
   &lt;fct&gt;   &lt;fct&gt;             &lt;dbl&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt; &lt;fct&gt; &lt;int&gt;
 1 Adelie  Torgersen          39.1    18.7     181    3750 male   2007
 2 Adelie  Torgersen          39.5    17.4     186    3800 fema~  2007
 3 Adelie  Torgersen          40.3    18       195    3250 fema~  2007
 4 Adelie  Torgersen          NA      NA        NA      NA &lt;NA&gt;   2007
 5 Adelie  Torgersen          36.7    19.3     193    3450 fema~  2007
 6 Adelie  Torgersen          39.3    20.6     190    3650 male   2007
 7 Adelie  Torgersen          38.9    17.8     181    3625 fema~  2007
 8 Adelie  Torgersen          39.2    19.6     195    4675 male   2007
 9 Adelie  Torgersen          34.1    18.1     193    3475 &lt;NA&gt;   2007
10 Adelie  Torgersen          42      20.2     190    4250 &lt;NA&gt;   2007
# ... with 334 more rows, and abbreviated variable names
#   1: bill_length_mm, 2: bill_depth_mm, 3: flipper_length_mm,
#   4: body_mass_g</code></pre>
</div>
<p>For simplicity, I will be imputing the missing values in the dataset by using bagged trees.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>gen_recipe</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'>recipe</span><span class='op'>(</span><span class='va'>species</span> <span class='op'>~</span> <span class='va'>.</span></span>
<span>         ,data <span class='op'>=</span> <span class='va'>penguins</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>step_impute_bag</span><span class='op'>(</span><span class='fu'>all_predictors</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>prep</span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>df_imputed</span> <span class='op'>&lt;-</span> <span class='fu'>bake</span><span class='op'>(</span><span class='va'>gen_recipe</span>, <span class='va'>penguins</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="brulee-package"><code>brulee</code> package</h2>
<p>For the first model, I will be using <code>brulee</code> package to fit the model.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mulnorm_specs</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'>multinom_reg</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>set_engine</span><span class='op'>(</span><span class='st'>"brulee"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Then, I define the pre-processing steps as suggested by the authors of Tidy Modeling with R <span class="citation" data-cites="Kuhn2023">(<a href="#ref-Kuhn2023" role="doc-biblioref">Kuhn and Silge 2023</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mulnorm_recipe</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'>recipe</span><span class='op'>(</span><span class='va'>species</span> <span class='op'>~</span> <span class='va'>flipper_length_mm</span> <span class='op'>+</span> <span class='va'>island</span></span>
<span>         ,data <span class='op'>=</span> <span class='va'>df_imputed</span><span class='op'>)</span> <span class='op'>%&gt;%</span></span>
<span>  <span class='fu'>step_nzv</span><span class='op'>(</span><span class='fu'>all_predictors</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>step_dummy</span><span class='op'>(</span><span class='fu'>all_nominal_predictors</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>step_normalize</span><span class='op'>(</span><span class='fu'>all_numeric_predictors</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Once that is done, I will “chain” all the different parts into a workflow.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mulnorm_wk</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'>workflow</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>add_model</span><span class='op'>(</span><span class='va'>mulnorm_specs</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>add_recipe</span><span class='op'>(</span><span class='va'>mulnorm_recipe</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>mulnorm_wk</span></span></code></pre>
</div>
<pre><code>== Workflow ==========================================================
Preprocessor: Recipe
Model: multinom_reg()

-- Preprocessor ------------------------------------------------------
3 Recipe Steps

* step_nzv()
* step_dummy()
* step_normalize()

-- Model -------------------------------------------------------------
Multinomial Regression Model Specification (classification)

Computational engine: brulee </code></pre>
</div>
<p>I will then fit the model.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mulnorm_fit</span> <span class='op'>&lt;-</span></span>
<span>  <span class='va'>mulnorm_wk</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>fit</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>df_imputed</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>mulnorm_fit</span></span></code></pre>
</div>
<pre><code>== Workflow [trained] ================================================
Preprocessor: Recipe
Model: multinom_reg()

-- Preprocessor ------------------------------------------------------
3 Recipe Steps

* step_nzv()
* step_dummy()
* step_normalize()

-- Model -------------------------------------------------------------
Multinomial regression

344 samples, 3 features, 3 classes 
class weights Adelie=1, Chinstrap=1, Gentoo=1 
weight decay: 0.001 
batch size: 310 
validation loss after 2 epochs: 0.225 </code></pre>
</div>
<p>I will extract the predicted values by using <code>augment</code> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mulnorm_predict</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'>augment</span><span class='op'>(</span><span class='va'>mulnorm_fit</span>, <span class='va'>df_imputed</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>mulnorm_predict</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>slice_head</span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 10 x 12
   island  bill_~1 bill_~2 flipp~3 body_~4 sex    year species .pred~5
   &lt;fct&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt; &lt;fct&gt; &lt;int&gt; &lt;fct&gt;   &lt;fct&gt;  
 1 Torger~    39.1    18.7     181    3750 male   2007 Adelie  Adelie 
 2 Torger~    39.5    17.4     186    3800 fema~  2007 Adelie  Adelie 
 3 Torger~    40.3    18       195    3250 fema~  2007 Adelie  Adelie 
 4 Torger~    38.0    18.3     187    3547 fema~  2007 Adelie  Adelie 
 5 Torger~    36.7    19.3     193    3450 fema~  2007 Adelie  Adelie 
 6 Torger~    39.3    20.6     190    3650 male   2007 Adelie  Adelie 
 7 Torger~    38.9    17.8     181    3625 fema~  2007 Adelie  Adelie 
 8 Torger~    39.2    19.6     195    4675 male   2007 Adelie  Adelie 
 9 Torger~    34.1    18.1     193    3475 fema~  2007 Adelie  Adelie 
10 Torger~    42      20.2     190    4250 male   2007 Adelie  Adelie 
# ... with 3 more variables: .pred_Adelie &lt;dbl&gt;,
#   .pred_Chinstrap &lt;dbl&gt;, .pred_Gentoo &lt;dbl&gt;, and abbreviated
#   variable names 1: bill_length_mm, 2: bill_depth_mm,
#   3: flipper_length_mm, 4: body_mass_g, 5: .pred_class</code></pre>
</div>
<p><code>yardstick</code> package also offers <code>mn_log_loss</code> function to compute the logarithmic loss of the multinomial logistic model.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mulnorm_predict</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mn_log_loss</span><span class='op'>(</span><span class='va'>species</span>, <span class='fl'>10</span><span class='op'>:</span><span class='fl'>12</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 1 x 3
  .metric     .estimator .estimate
  &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt;
1 mn_log_loss multiclass     0.231</code></pre>
</div>
<h2 id="vglm-function-from-vgam-package"><code>vglm</code> function from <code>VGAM</code> package</h2>
<p>Next, I will use <code>vglm</code> function from <code>VGAM</code> package to build the model.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>vglm_fit</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='fu'>vglm</span><span class='op'>(</span><span class='va'>species</span> <span class='op'>~</span> <span class='va'>flipper_length_mm</span> <span class='op'>+</span> <span class='va'>island</span></span>
<span>       ,data <span class='op'>=</span> <span class='va'>df_imputed</span></span>
<span>       ,family <span class='op'>=</span> <span class='va'>multinomial</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>vglm_fit</span></span></code></pre>
</div>
<pre><code>
Call:
vglm(formula = species ~ flipper_length_mm + island, family = multinomial, 
    data = df_imputed)


Coefficients:
      (Intercept):1       (Intercept):2 flipper_length_mm:1 
         266.738752          232.014117           -1.313793 
flipper_length_mm:2       islandDream:1       islandDream:2 
          -1.182953           14.639756           24.346370 
  islandTorgersen:1   islandTorgersen:2 
          16.200276           13.866865 

Degrees of Freedom: 688 Total; 680 Residual
Residual deviance: 151.3212 
Log-likelihood: -75.66059 

This is a multinomial logit model with 3 levels</code></pre>
</div>
<p>We could pass the fitted object into the <code>summary</code> function to check the results.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>vglm_fit</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
Call:
vglm(formula = species ~ flipper_length_mm + island, family = multinomial, 
    data = df_imputed)

Coefficients: 
                    Estimate Std. Error z value Pr(&gt;|z|)
(Intercept):1        266.739    228.834   1.166    0.244
(Intercept):2        232.014    229.712   1.010    0.312
flipper_length_mm:1   -1.314      1.127      NA       NA
flipper_length_mm:2   -1.183      1.128  -1.049    0.294
islandDream:1         14.640     17.702   0.827    0.408
islandDream:2         24.346     25.933      NA       NA
islandTorgersen:1     16.200     34.789      NA       NA
islandTorgersen:2     13.867     62.409   0.222    0.824

Names of linear predictors: log(mu[,1]/mu[,3]), log(mu[,2]/mu[,3])

Residual deviance: 151.3212 on 680 degrees of freedom

Log-likelihood: -75.6606 on 680 degrees of freedom

Number of Fisher scoring iterations: 18 

Warning: Hauck-Donner effect detected in the following estimate(s):
&#39;flipper_length_mm:1&#39;, &#39;islandDream:2&#39;, &#39;islandTorgersen:1&#39;


Reference group is level  3  of the response</code></pre>
</div>
<p>Hmm, it seems there is an issue (i.e., Hauk-Donner effect) in the dataset.</p>
<p>According to this <a href="https://arxiv.org/abs/2001.08431#:~:text=This%20paper%20develops%20on%20another,estimate%20and%20the%20null%20value.">paper</a>, Hauck-Donner effect (HDE) whereby a Wald test statistic is not monotonely increasing as a function of increasing distance between the parameter estimate and the null value.</p>
<p>However, for simplicity, I won’t be exploring what is Hauck-Donner effect and how to fix it.</p>
<p>Alternatively, we could extract the coefficients from the fitted object by using <code>coef.vlm</code> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>coef.vlm</span><span class='op'>(</span><span class='va'>vglm_fit</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>      (Intercept):1       (Intercept):2 flipper_length_mm:1 
         266.738752          232.014117           -1.313793 
flipper_length_mm:2       islandDream:1       islandDream:2 
          -1.182953           14.639756           24.346370 
  islandTorgersen:1   islandTorgersen:2 
          16.200276           13.866865 </code></pre>
</div>
<p>The cool thing about this function is that <code>ANOVA</code> function still works on the fitted object from this function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>vglm_fit</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Analysis of Deviance Table (Type II tests)

Model: &#39;multinomial&#39;, &#39;VGAMcategorical&#39;

Link: &#39;multilogitlink&#39;

Response: species

                  Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    
flipper_length_mm  2   212.69       682     363.95 &lt; 2.2e-16 ***
island             4   136.78       684     288.04 &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<p>To extract the predictions, we could use <code>predict.vlm</code> function from the package to do so.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>predict.vlm</span><span class='op'>(</span><span class='va'>vglm_fit</span>, newdata <span class='op'>=</span> <span class='va'>df_imputed</span>, type <span class='op'>=</span> <span class='st'>"response"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>as_tibble</span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 344 x 2
   `log(mu[,1]/mu[,3])` `log(mu[,2]/mu[,3])`
                  &lt;dbl&gt;                &lt;dbl&gt;
 1                 45.1                 31.8
 2                 38.6                 25.9
 3                 26.7                 15.2
 4                 37.3                 24.7
 5                 29.4                 17.6
 6                 33.3                 21.1
 7                 45.1                 31.8
 8                 26.7                 15.2
 9                 29.4                 17.6
10                 33.3                 21.1
# ... with 334 more rows</code></pre>
</div>
<h2 id="multinom-function-from-nnet-package"><code>multinom</code> function from <code>nnet</code> package</h2>
<p>Lastly, I will use <code>nultinom</code> function from <code>nnet</code> package to fit the model.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>nnet_fit</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'>multinom</span><span class='op'>(</span><span class='va'>species</span> <span class='op'>~</span> <span class='va'>flipper_length_mm</span> <span class='op'>+</span> <span class='va'>island</span></span>
<span>          ,data <span class='op'>=</span> <span class='va'>df_imputed</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># weights:  15 (8 variable)
initial  value 377.922627 
iter  10 value 90.006785
iter  20 value 77.751017
iter  30 value 76.042914
iter  40 value 75.653015
iter  50 value 75.643330
final  value 75.643211 
converged</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>nnet_fit</span></span></code></pre>
</div>
<pre><code>Call:
multinom(formula = species ~ flipper_length_mm + island, data = df_imputed)

Coefficients:
          (Intercept) flipper_length_mm islandDream islandTorgersen
Chinstrap   -39.09934         0.1308451    14.08030       -15.62399
Gentoo     -277.66603         1.3677412   -19.38964      -107.33116

Residual Deviance: 151.2864 
AIC: 167.2864 </code></pre>
</div>
<p>According to the <a href="https://cran.r-project.org/web/packages/nnet/index.html">documentation</a>, the function uses neutral network to fit a multinomial logistic regression.</p>
<p>As such, some of the existing functions (e.g., ANOVA) would not work on the fitted object.</p>
<p>Note that the formula uses the first factor as the reference group.</p>
<p>We could change the reference level by using <code>relevel</code> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>df_imputed_relevel</span> <span class='op'>&lt;-</span> </span>
<span>  <span class='va'>df_imputed</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>mutate</span><span class='op'>(</span>species <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/relevel.html'>relevel</a></span><span class='op'>(</span><span class='va'>species</span>, ref <span class='op'>=</span> <span class='st'>"Gentoo"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>nnet_fit_relevel</span> <span class='op'>&lt;-</span></span>
<span>  <span class='fu'>multinom</span><span class='op'>(</span><span class='va'>species</span> <span class='op'>~</span> <span class='va'>flipper_length_mm</span> <span class='op'>+</span> <span class='va'>island</span></span>
<span>          ,data <span class='op'>=</span> <span class='va'>df_imputed_relevel</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># weights:  15 (8 variable)
initial  value 377.922627 
iter  10 value 92.441650
iter  20 value 83.835909
iter  30 value 79.695362
iter  40 value 75.911918
iter  50 value 75.681170
final  value 75.623715 
converged</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>nnet_fit_relevel</span></span></code></pre>
</div>
<pre><code>Call:
multinom(formula = species ~ flipper_length_mm + island, data = df_imputed_relevel)

Coefficients:
          (Intercept) flipper_length_mm islandDream islandTorgersen
Adelie       319.0516         -1.571624    82.64173        19.42912
Chinstrap    182.1415         -1.440774   194.53175        13.72710

Residual Deviance: 151.2474 
AIC: 167.2474 </code></pre>
</div>
<p>From the model, we noted the following:</p>
<ul>
<li><p>One unit increase in flipper length increases the log odd of Chinstrap vs Adelie and Gentoo vs Adelie by 1.14 and 3.93 respectively</p></li>
<li><p>If the penguins are from Dream Island, the species of penguins would be very likely to be Chinstrap</p></li>
<li><p>If the penguins are from Torgersen, the species of penguins are likely to be Adelie</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># display odds ratios in transposed data frame</span></span>
<span><span class='va'>odds_ratios</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>nnet_fit</span><span class='op'>)</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>odds_ratios</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>                     Chinstrap        Gentoo
(Intercept)       1.045614e-17 2.577365e-121
flipper_length_mm 1.139791e+00  3.926471e+00
islandDream       1.303154e+06  3.794789e-09
islandTorgersen   1.639034e-07  2.435947e-47</code></pre>
</div>
<p>Note that the log odds ratio is always calculated to the reference level. If we would like to compare the log ratio of Chinstrap and Gentoo, we will just need to exponential their coefficient difference to obtain the log ratio.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>coefs_c_to_b</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>nnet_fit</span><span class='op'>)</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span><span class='fl'>2</span>, <span class='op'>]</span> <span class='op'>-</span> </span>
<span>   <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>nnet_fit</span><span class='op'>)</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>coefs_c_to_b</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>                  exp.coefs_c_to_b.
(Intercept)           2.464929e-104
flipper_length_mm      3.444904e+00
islandDream            2.912002e-15
islandTorgersen        1.486209e-40</code></pre>
</div>
<p>We could extract the fitted values by extracting the <code>fitted.values</code> object from the fitted model.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>nnet_fit</span><span class='op'>$</span><span class='va'>fitted.values</span> <span class='op'>%&gt;%</span> </span>
<span>  <span class='fu'>as_tibble</span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 344 x 3
   Adelie Chinstrap   Gentoo
    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1   1.00  3.31e-14 2.05e-60
 2   1.00  6.36e-14 1.92e-57
 3   1.00  2.06e-13 4.25e-52
 4   1.00  7.25e-14 7.52e-57
 5   1.00  1.59e-13 2.76e-53
 6   1.00  1.07e-13 4.55e-55
 7   1.00  3.31e-14 2.05e-60
 8   1.00  2.06e-13 4.25e-52
 9   1.00  1.59e-13 2.76e-53
10   1.00  1.07e-13 4.55e-55
# ... with 334 more rows</code></pre>
</div>
<p>The result shows the likelihood of the selected penguin belonging to a particular species.</p>
<h1 id="conclusion">Conclusion</h1>
<p>That’s all for the day!</p>
<p>Thanks for reading the post until the end.</p>
<p>Feel free to contact me through <a href="mailto:jasper.jh.lok@gmail.com">email</a> or <a href="https://www.linkedin.com/in/jasper-l-13426232/">LinkedIn</a> if you have any suggestions on future topics to share.</p>
<p>Refer to this link for the <a href="https://jasperlok.netlify.app/blog_disclaimer.html">blog disclaimer</a>.</p>
<p>Till next time, happy learning!</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="image/penguins2.jpg" width="100%" /></p>
</div>
<p>Photo by <a href="https://unsplash.com/@thetdmaster?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash">Thomas Denton</a> on <a href="https://unsplash.com/photos/penguin-standing-on-brown-rock-during-daytime-pjt4AzvfTh0?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash">Unsplash</a></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-CrossValidated2013" class="csl-entry" role="listitem">
Cross Validated. 2013. <span>“Multinomial Logistic Regression Vs One-Vs-Rest Binary Logistic Regression.”</span> <a href="https://stats.stackexchange.com/questions/52104/multinomial-logistic-regression-vs-one-vs-rest-binary-logistic-regression">https://stats.stackexchange.com/questions/52104/multinomial-logistic-regression-vs-one-vs-rest-binary-logistic-regression</a>.
</div>
<div id="ref-Kuhn2023" class="csl-entry" role="listitem">
Kuhn, Max, and Julia Silge. 2023. <span>“A Recommended Preprocessing.”</span> <a href="https://www.tmwr.org/pre-proc-table">https://www.tmwr.org/pre-proc-table</a>.
</div>
<div id="ref-ASC2024" class="csl-entry" role="listitem">
National University Academic Success Centre. 2024. <span>“Multinomial Logistic Regression.”</span> <a href="https://resources.nu.edu/statsresources/Multinomiallogistic#:~:text=A%20multinomial%20logistic%20regression%20(or,that%20are%20categorical%20or%20continuous.">https://resources.nu.edu/statsresources/Multinomiallogistic#:~:text=A%20multinomial%20logistic%20regression%20(or,that%20are%20categorical%20or%20continuous.</a>
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
