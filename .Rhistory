geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 15) +
theme_minimal()
text_df_lemma_3_tidy_count %>%
filter(tot_count >= 60) %>%
ggplot(aes(label = term, size = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 20) +
theme_minimal()
text_df_lemma_3_tidy_count %>%
filter(tot_count >= 60) %>%
ggplot(aes(label = term, size = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 20) +
theme_minimal()
text_df_lemma_3_tidy_count %>%
filter(tot_count >= 60) %>%
ggplot(aes(label = term, size = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 18) +
theme_minimal()
text_df_lemma_3_tidy_count %>%
filter(tot_count >= 55) %>%
ggplot(aes(label = term, size = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 15) +
theme_minimal()
text_df_lemma_3_tidy_count %>%
filter(tot_count >= 50) %>%
ggplot(aes(label = term, size = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 15) +
theme_minimal()
text_df_lemma_3_tidy_count %>%
filter(tot_count >= 50) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 15) +
theme_minimal()
text_df_lemma_3_tidy_count %>%
filter(tot_count >= 50) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 18) +
theme_minimal()
text_df_lemma_3_tidy_count %>%
filter(tot_count >= 50) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 15) +
theme_minimal()
text_df_lemma_3_tidy_count %>%
filter(tot_count >= 45) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 12) +
theme_minimal()
text_df_lemma_3_tidy_count %>%
filter(tot_count >= 45) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 14) +
theme_minimal()
text_df_lemma_3
object(text_df_lemma_3)
View(text_df_lemma_3)
temp <- tidy(df_lda_lemma_3)
View(temp)
View(text_df_lemma_1_tidy)
df_lda_lemma_3_tidy <- tidy(df_lda_lemma_3, matrix = "beta")
topfeatures(text_df_lemma_1, 20)
topfeatures(text_df_lemma_3, 20)
topfeatures(text_df_lemma_1, 20)
text_df_lemma_1 <- text_df_lemma %>%
dfm()
topfeatures(text_df_lemma_1, 20)
text_df_lemma_1_tidy_count %>%
filter(tot_count >= 500) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 130) +
theme_minimal()
text_df_lemma_3 <- text_df_lemma %>%
tokens_ngrams(n = 2:3, concatenator = " ") %>%
dfm()
text_df_lemma_3 <- text_df_lemma_3 %>%
dfm_trim(min_termfreq = 0.995, termfreq_type = "quantile",
max_docfreq = 1000, docfreq_type = "count") %>%
dfm_tfidf()
text_df_lemma_3_tidy <- tidy(text_df_lemma_3)
text_df_lemma_3_tidy_count <- text_df_lemma_3_tidy %>%
group_by(term) %>%
summarise(tot_count = sum(count))
text_df_lemma_3_tidy_count %>%
filter(tot_count >= 45) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 14) +
theme_minimal()
rowTotals <- apply(text_df_lemma_3, 1, sum) #Find the sum of words in each Document
text_df_lemma_3_new <- text_df_lemma_3[rowTotals> 0, ]
df_lda_lemma_3 <- LDA(text_df_lemma_3_new,
k = 5,
control = list(seed = 1234))
View(text_df_lemma_3)
text_df_lemma_3 <- text_df_lemma %>%
tokens_ngrams(n = 2:3, concatenator = " ") %>%
dfm()
text_df_lemma_3 <- text_df_lemma_3 %>%
dfm_trim(min_termfreq = 0.995, termfreq_type = "quantile",
max_docfreq = 1000, docfreq_type = "count")
rowTotals <- apply(text_df_lemma_3, 1, sum) #Find the sum of words in each Document
text_df_lemma_3_new <- text_df_lemma_3[rowTotals> 0, ]
df_lda_lemma_3 <- LDA(text_df_lemma_3_new,
k = 5,
control = list(seed = 1234))
text_df_lemma_3 <- text_df_lemma %>%
tokens_ngrams(n = 2:3, concatenator = " ") %>%
dfm()
text_df_lemma_3 <- text_df_lemma_3 %>%
dfm_trim(min_termfreq = 0.995, termfreq_type = "quantile")#,
#max_docfreq = 1000, docfreq_type = "count")
temp <- text_df_lemma_3 %>%
dfm_tfidf()
topfeatures(text_df_lemma_3, 20)
topfeatures(temp, 20)
text_df_lemma_3 <- text_df_lemma %>%
tokens_ngrams(n = 2:3, concatenator = " ") %>%
dfm()
topfeatures(text_df_lemma_3, 20)
text_df_lemma_3 <- text_df_lemma_3 %>%
dfm_trim(min_termfreq = 0.99, termfreq_type = "quantile",
max_docfreq = 1000, docfreq_type = "count")
text_df_lemma_3_tidy <- tidy(text_df_lemma_3)
text_df_lemma_3_tidy_count <- text_df_lemma_3_tidy %>%
group_by(term) %>%
summarise(tot_count = sum(count))
text_df_lemma_3_tidy_count %>%
filter(tot_count >= 45) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 14) +
theme_minimal()
text_df_lemma_3 <- text_df_lemma_3 %>%
dfm_trim(min_termfreq = 0.99, termfreq_type = "quantile",
max_termfreq = 1000, docfreq_type = "count")
text_df_lemma_3 <- text_df_lemma_3 %>%
dfm_trim(max_termfreq = 1000, termfreq_type = "count")
text_df_lemma_3_tidy <- tidy(text_df_lemma_3)
text_df_lemma_3_tidy_count <- text_df_lemma_3_tidy %>%
group_by(term) %>%
summarise(tot_count = sum(count))
text_df_lemma_3_tidy_count %>%
filter(tot_count >= 45) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 14) +
theme_minimal()
#rowTotals <- apply(text_df_lemma_3, 1, sum) #Find the sum of words in each Document
#text_df_lemma_3_new <- text_df_lemma_3[rowTotals> 0, ]
df_lda_lemma_3 <- LDA(text_df_lemma_3_new,
k = 5,
control = list(seed = 1234))
text_df_lemma_3 <- text_df_lemma %>%
tokens_ngrams(n = 2:3, concatenator = " ") %>%
dfm()
text_df_lemma_3 <- text_df_lemma_3 %>%
dfm_trim(max_termfreq = 1000, termfreq_type = "count")
#rowTotals <- apply(text_df_lemma_3, 1, sum) #Find the sum of words in each Document
#text_df_lemma_3_new <- text_df_lemma_3[rowTotals> 0, ]
df_lda_lemma_3 <- LDA(text_df_lemma_3_new,
k = 5,
control = list(seed = 1234))
df_lda_lemma_3
df_lda_lemma_3
df_lda_lemma_3 <- LDA(text_df_lemma_3_new,
k = 6,
control = list(seed = 1234))
df_lda_lemma_3
ls(df_lda_lemma_3)
names(df_lda_lemma_3.object)
names(df_lda_lemma_3)
df_lda_lemma_3$beta
df_lda_lemma_3_tidy <- tidy(df_lda_lemma_3)
df_lda_lemma_3_tidy
df_lda_lemma_3_tidy_gamma <- tidy(df_lda_lemma_3, matrix = "gamma")
df_lda_lemma_3_tidy_gamma
View(df_lda_lemma_3_tidy_gamma)
rowTotals <- apply(text_df_lemma_3, 1, sum)
rowTotals <- apply(text_df_lemma_3, sum, 1)
text_df_lemma_3 <- text_df_lemma %>%
tokens_ngrams(n = 2:3, concatenator = " ") %>%
dfm()
text_df_lemma_3 <- text_df_lemma_3 %>%
dfm_trim(max_termfreq = 1000, termfreq_type = "count")
rowTotals <- apply(text_df_lemma_3, 1, sum)
#rowTotals <- apply(text_df_lemma_3, 1, sum)
#text_df_lemma_3_new <- text_df_lemma_3[rowTotals > 0]
df_lda_lemma_3 <- LDA(text_df_lemma_3,
k = 6,
control = list(seed = 1234))
rowTotals <- apply(text_df_lemma_3, 1, sum)
text_df_lemma_3 <- text_df_lemma_3 %>%
dfm_trim(min_termfreq = 30,
max_termfreq = 1000,
termfreq_type = "count")
rowTotals <- apply(text_df_lemma_3, 1, sum)
text_df_lemma_3_new <- text_df_lemma_3[rowTotals > 0]
rowTotals <- apply(text_df_lemma_3, 1, sum)
text_df_lemma_3_new <- text_df_lemma_3[rowTotals > 0,]
df_lda_lemma_3 <- LDA(text_df_lemma_3,
k = 6,
control = list(seed = 1234))
rowTotals <- apply(text_df_lemma_3, 1, sum)
text_df_lemma_3_new <- text_df_lemma_3[rowTotals > 0, ]
df_lda_lemma_3 <- LDA(text_df_lemma_3_new,
k = 6,
control = list(seed = 1234))
df_lda_lemma_3
df_lda_lemma_3_tidy <- tidy(df_lda_lemma_3)
df_lda_lemma_3_tidy
df_lda_lemma_3_tidy_terms <- df_lda_lemma_3_tidy %>%
group_by(topic) %>%
slice_max(beta, n = 10) %>%
ungroup() %>%
arrange(topic, -beta)
df_lda_lemma_3_tidy_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered()
df_lda_lemma_3_tidy_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered() +
theme_minimal()
text_df_lemma_1_tidy_count %>%
filter(tot_count >= 500) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 130) +
theme_minimal()
text_df_lemma_1_tidy_count %>%
filter(tot_count >= 500) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 30) +
theme_minimal()
text_df_lemma_1_tidy_count %>%
filter(tot_count >= 500) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area() +
theme_minimal()
text_df_lemma_1_tidy_count %>%
filter(tot_count >= 400) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area() +
theme_minimal()
text_df_lemma_1_tidy_count <- text_df_lemma_1_tidy %>%
group_by(term) %>%
summarise(tot_count = sum(count))
text_df_lemma_1_tidy_count %>%
filter(tot_count >= 500) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area() +
theme_minimal()
text_df_lemma_1_tidy_count %>%
filter(tot_count >= 500) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 300) +
theme_minimal()
text_df_lemma_1_tidy_count %>%
filter(tot_count >= 500) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 250) +
theme_minimal()
df_lda_lemma_3_tidy_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered() +
theme_minimal()
options(htmltools.dir.version = FALSE)
packages <- c("captioner", "knitr", "tidyverse", "kableExtra")
for (p in packages){
if(!require (p, character.only = T)){
install.packages(p)
}
library(p, character.only = T)
}
knitr::opts_chunk$set(fig.retina = 3,
echo = TRUE,
eval = TRUE,
message = FALSE,
warning = FALSE,
out.width="90%")
library(captioner)
knitr::include_graphics("image/books.jpg")
knitr::include_graphics("image/mapping_topicModeling.png")
knitr::include_graphics("image/Notation of Topic Modeling.png")
knitr::include_graphics("image/textanalytics_with_r.png")
packages <- c('tidyverse', 'readr', 'skimr', 'tidytext', 'quanteda',
'ggwordcloud', 'lexicon', 'topicmodels')
for(p in packages){
if(!require (p, character.only = T)){
install.packages(p)
}
library(p, character.only = T)
}
df <- read_tsv("C:/Users/Jasper Lok/Documents/2_Data Science/my-blog/_posts/2021-12-02-text-analytics/data/WikiQA.tsv",
quote = "\t")
text_df <- tokens(df$Sentence,
remove_punct = TRUE,
remove_numbers = TRUE,
remove_symbols = TRUE,
remove_separators = TRUE,
split_hyphens = FALSE)
text_df <- text_df %>%
tokens_tolower()
text_df <- text_df %>%
tokens_remove(stopwords(language = "en", source = "smart"), padding = FALSE)
text_df <- text_df %>%
tokens_replace(pattern = c("\\d\\w*"), replacement = c(""), valuetype = "regex")
text_df <- text_df %>%
tokens_replace(pattern = c("\\-"), replacement = c(""), valuetype = "regex")
text_df <- text_df %>%
tokens_replace(pattern = c("united st", "u.s"),
replacement = c("united state", "united state"),
valuetype = "fixed") %>%
tokens()
text_df_lemma <- text_df %>%
tokens_replace(pattern = lexicon::hash_lemmas$token,
replacement = lexicon::hash_lemmas$lemma)
text_df_lemma_1 <- text_df_lemma %>%
dfm()
text_df_lemma_1 <- text_df_lemma_1  %>%
dfm_trim(min_termfreq = 10)
topfeatures(text_df_lemma_1, 20)
text_df_lemma_1_tidy <- tidy(text_df_lemma_1)
text_df_lemma_1_tidy_count <- text_df_lemma_1_tidy %>%
group_by(term) %>%
summarise(tot_count = sum(count))
text_df_lemma_1_tidy_count %>%
filter(tot_count >= 500) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 500) +
theme_minimal()
text_df_lemma_3 <- text_df_lemma %>%
tokens_ngrams(n = 2:3, concatenator = " ") %>%
dfm()
topfeatures(text_df_lemma_3, 20)
text_df_lemma_3 <- text_df_lemma_3 %>%
dfm_trim(min_termfreq = 30,
max_termfreq = 1000,
termfreq_type = "count")
text_df_lemma_3_tidy <- tidy(text_df_lemma_3)
text_df_lemma_3_tidy_count <- text_df_lemma_3_tidy %>%
group_by(term) %>%
summarise(tot_count = sum(count))
text_df_lemma_3_tidy_count %>%
filter(tot_count >= 45) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 14) +
theme_minimal()
rowTotals <- apply(text_df_lemma_3, 1, sum)
text_df_lemma_3_new <- text_df_lemma_3[rowTotals > 0, ]
df_lda_lemma_3 <- LDA(text_df_lemma_3_new,
k = 6,
control = list(seed = 1234))
df_lda_lemma_3
df_lda_lemma_3_tidy <- tidy(df_lda_lemma_3)
df_lda_lemma_3_tidy
df_lda_lemma_3_tidy_terms <- df_lda_lemma_3_tidy %>%
group_by(topic) %>%
slice_max(beta, n = 10) %>%
ungroup() %>%
arrange(topic, -beta)
df_lda_lemma_3_tidy_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered() +
theme_minimal()
knitr::include_graphics("image/reading.jpg")
df_lda_lemma_3@beta
df_lda_lemma_3@alpha
temp_file()
tempfile()
df_lda_lemma_3_tidy_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered() +
theme(text = element_text(size = 20)) +
theme_minimal()
df_lda_lemma_3_tidy_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered() +
theme(text = element_text(size = 20)) +
theme_minimal()
df_lda_lemma_3_tidy_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered() +
theme(text = element_text(size = 30)) +
theme_minimal()
df_lda_lemma_3_tidy_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered() +
#  theme() +
theme_minimal(text = element_text(size = 30))
df_lda_lemma_3_tidy_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered() +
theme(text = element_text(size = 30))# +
#  theme_minimal()
df_lda_lemma_3_tidy_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered() +
theme(text = element_text(size = 20))# +
#  theme_minimal()
df_lda_lemma_3_tidy_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered() +
theme_minimal() +
theme(text = element_text(size = 20))
knitr::include_graphics("image/lda_results.png")
df_lda_lemma_3_tidy_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered() +
theme_minimal() +
theme(text = element_text(size = 20))
df_lda_lemma_3_tidy_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered() +
theme_minimal() +
theme(text = element_text(size = 20))
df_lda_lemma_3 <- LDA(text_df_lemma_3_new,
k = 5,
control = list(seed = 0,
nstart = 1))
df_lda_lemma_3
df_lda_lemma_3@alpha
df_lda_lemma_3_tidy <- tidy(df_lda_lemma_3)
df_lda_lemma_3_tidy
df_lda_lemma_3_tidy_terms <- df_lda_lemma_3_tidy %>%
group_by(topic) %>%
slice_max(beta, n = 10) %>%
ungroup() %>%
arrange(topic, -beta)
df_lda_lemma_3_tidy_terms %>%
mutate(term = reorder_within(term, beta, topic)) %>%
ggplot(aes(beta, term, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~topic, scales = "free") +
scale_y_reordered() +
theme_minimal() +
theme(text = element_text(size = 20))
knitr::include_graphics("image/lda_results.png")
knitr::include_graphics("image/reading.jpg")
knitr::include_graphics("image/lda_results.png")
text_df_lemma_1_tidy_count %>%
filter(tot_count >= 500) %>%
ggplot(aes(label = term, size = tot_count, color = tot_count)) +
geom_text_wordcloud_area(shape  = "square") +
scale_size_area(max_size = 500) +
theme_minimal()
# As the topics are being randomized, hence screen shot the results
knitr::include_graphics("image/lda_results.png")
# As the topics are being randomized, hence screen shot the results
knitr::include_graphics("image/lda_results.png")
df_lda_lemma_3_tidy <- tidy(df_lda_lemma_3)
df_lda_lemma_3_tidy
df_lda_lemma_3_tidy <- tidy(df_lda_lemma_3)
df_lda_lemma_3_tidy
knitr::include_graphics("image/question mark.jpg")
